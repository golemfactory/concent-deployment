server {
    listen 80;

    gzip            on;
    gzip_min_length 1000;
    gzip_proxied    expired no-cache no-store private auth;
    gzip_types      text/plain text/css text/javascript application/xml;

    location /download/ {
        alias /srv/storage/;
    }

    location /upload  {
        limit_except POST              { deny all; }
        client_body_temp_path          /srv/storage/;
        client_body_in_file_only       on;
        client_body_buffer_size        300m;
        client_max_body_size           {{ max_upload_size }};
        proxy_pass_request_headers     on;
        proxy_set_header               X-FILE $request_body_file;
        proxy_set_body                 $request_body_file;
        proxy_pass                     http://nginx-storage/result/;
        proxy_redirect                 off;
    }

   location = /result/ {
        return 200 "File was upload";
    }
}
